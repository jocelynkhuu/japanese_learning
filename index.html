<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Japanese Verb Quiz (Genki I)</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body { padding: 2rem; }
    .correct { color: green; font-weight: bold; }
    .incorrect { color: red; font-weight: bold; }
    .sticky-footer {
      position: fixed;
      bottom: 0;
      left: 0;
      width: 100%;
      background: #f8f9fa;
      border-top: 1px solid #ddd;
      padding: 0.75rem;
      text-align: center;
      z-index: 1000;
    }
    h3.lesson-heading {
      margin-top: 2rem;
      padding-top: 1rem;
      border-top: 2px solid #ccc;
    }
  </style>
</head>
<body class="bg-light">
  <div class="container">
    <h1 class="mb-4">📘 Japanese Verb Quiz (Genki I)</h1>

    <!-- Menu -->
    <div id="menu" class="mb-3">
      <!-- Te-form Cheat Sheet -->
      <div class="card mb-4">
        <div class="card-header bg-primary text-white">
          📖 Te-form Conjugation Rules
        </div>
        <div class="card-body">
          <table class="table table-bordered table-sm text-center">
            <thead class="table-light">
              <tr>
                <th>Ending</th>
                <th>Rule → て-form</th>
                <th>Example</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>う, つ, る</td>
                <td>→ って</td>
                <td>あう → あって</td>
              </tr>
              <tr>
                <td>む, ぶ, ぬ</td>
                <td>→ んで</td>
                <td>のむ → のんで</td>
              </tr>
              <tr>
                <td>く</td>
                <td>→ いて</td>
                <td>きく → きいて</td>
              </tr>
              <tr>
                <td>ぐ</td>
                <td>→ いで</td>
                <td>およぐ → およいで</td>
              </tr>
              <tr>
                <td>す</td>
                <td>→ して</td>
                <td>はなす → はなして</td>
              </tr>
              <tr>
                <td>る (Ichidan / Ru-verbs)</td>
                <td>→ て</td>
                <td>たべる → たべて</td>
              </tr>
              <tr>
                <td>Irregular</td>
                <td>
                  する → して <br>
                  くる → きて <br>
                  いく → いって
                </td>
                <td></td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <button class="btn btn-primary me-2" onclick="startQuiz()">Take a Quiz</button>
      <button class="btn btn-secondary" onclick="showList()">List All Verbs</button>
    </div>

  <!-- Quiz -->
  <div id="quiz" style="display:none; position: relative; min-height: 100vh;">
    <h2>Quiz</h2>
    <div class="mb-3">
      <label class="form-label">How many questions? (1–<span id="totalVerbs"></span>):</label>
      <input type="number" id="numQuestions" class="form-control w-25 d-inline-block" min="1" value="5">
    </div>
    <div class="mb-3">
      <label class="form-label">Choose form to practice:</label>
      <select id="quizType" class="form-select w-25 d-inline-block">
        <option value="te">Te-form</option>
        <option value="masu">Masu-form</option>
      </select>
    </div>
    <div class="mb-3">
      <label class="form-label">Choose lesson:</label>
      <select id="lessonFilter" class="form-select w-25 d-inline-block"></select>
      <button class="btn btn-success ms-2" onclick="generateQuiz()">Start</button>
    </div>
    <div class="mb-3 form-check">
      <input type="checkbox" class="form-check-input" id="skipIrregular">
      <label class="form-check-label" for="skipIrregular">Skip irregular verbs</label>
    </div>


    <!-- Quiz questions will go here -->
    <form id="quizForm" onsubmit="checkAnswers(); return false;"></form>

    <!-- Sticky footer always visible -->
    <div class="sticky-footer">
      <button class="btn btn-primary" onclick="reset()">🔙 Back to Menu</button>
    </div>
  </div>


    <!-- Results -->
    <div id="results" style="display:none;">
      <h2>Results</h2>
      <div id="resultsContent"></div>
      <div class="sticky-footer">
        <button class="btn btn-primary" onclick="reset()">🔙 Back to Menu</button>
      </div>
    </div>

    <!-- Verb List -->
    <div id="list" style="display:none; position: relative; min-height: 100vh;">
      <h2>All Verbs by Lesson</h2>
      <div id="verbTables"></div>
      <div class="sticky-footer">
        <button class="btn btn-primary" onclick="reset()">🔙 Back to Menu</button>
      </div>
    </div>
  </div>

  <script>
    // ==== Example verbs (replace with your full list) ====
    const verbs = [
      // ==== U-verbs ====
      {dict: "あう", kanji: "<ruby>会<rt>あ</rt></ruby>う", type: "u-verb",
      te: ["あって","会って"], masu: ["あいます","会います"], meaning: "to meet; to see (a person)", lesson: 4},
      {dict: "ある", type: "u-verb",
      te: ["あって"], masu: ["あります"], meaning: "there is... (place に thing が)", lesson: 4},
      {dict: "あそぶ", kanji: "<ruby>遊<rt>あそ</rt></ruby>ぶ", type: "u-verb",
      te: ["あそんで","遊んで"], masu: ["あそびます","遊びます"], meaning: "to play; to spend time pleasantly", lesson: 6},
      {dict: "かぶる", kanji: "かぶる", type: "u-verb",
      te: ["かぶって"], masu: ["かぶります"], meaning: "to put on (a hat) (~を)", lesson: 7},
      {dict: "はく", kanji: "はく", type: "u-verb",
      te: ["はいて"], masu: ["はきます"], meaning: "to put on (items below waist) (~を)", lesson: 7},
      {dict: "しる", kanji: "<ruby>知<rt>し</rt></ruby>る", type: "u-verb",
      te: ["しって","知って"], masu: ["しります","知ります"], meaning: "to get to know (~を)", lesson: 7},
      {dict: "すむ", kanji: "<ruby>住<rt>す</rt></ruby>む", type: "u-verb",
      te: ["すんで","住んで"], masu: ["すみます","住みます"], meaning: "to live", lesson: 7},
      {dict: "はたらく", kanji: "<ruby>働<rt>はたら</rt></ruby>く", type: "u-verb",
      te: ["はたらいて","働いて"], masu: ["はたらきます","働きます"], meaning: "to work", lesson: 7},
      {dict: "ふとる", kanji: "<ruby>太<rt>ふと</rt></ruby>る", type: "u-verb",
      te: ["ふとって","太って"], masu: ["ふとります","太ります"], meaning: "to gain weight", lesson: 7},
      {dict: "いく", kanji: "<ruby>行<rt>い</rt></ruby>く", type: "u-verb (exception)",
      te: ["いって","行って"], masu: ["いきます","行きます"], meaning: "to go", lesson: 3},
      {dict: "いう", kanji: "<ruby>言<rt>い</rt></ruby>う", type: "u-verb",
      te: ["いって","言って"], masu: ["いいます","言います"], meaning: "to say", lesson: 8},
      {dict: "いそぐ", kanji: "<ruby>急<rt>いそ</rt></ruby>ぐ", type: "u-verb",
      te: ["いそいで","急いで"], masu: ["いそぎます","急ぎます"], meaning: "to hurry", lesson: 6},
      {dict: "うたう", kanji: "<ruby>歌<rt>うた</rt></ruby>う", type: "u-verb",
      te: ["うたって","歌って"], masu: ["うたいます","歌います"], meaning: "to sing (~を)", lesson: 7},
      {dict: "おどる", kanji: "<ruby>踊<rt>おど</rt></ruby>る", type: "u-verb",
      te: ["おどって","踊って"], masu: ["おどります","踊ります"], meaning: "to dance", lesson: 9},
      {dict: "おわる", kanji: "<ruby>終<rt>お</rt></ruby>わる", type: "u-verb",
      te: ["おわって","終わって"], masu: ["おわります","終わります"], meaning: "something ends (~が)", lesson: 9},
      {dict: "およぐ", kanji: "<ruby>泳<rt>およ</rt></ruby>ぐ", type: "u-verb",
      te: ["およいで","泳いで"], masu: ["およぎます","泳ぎます"], meaning: "to swim", lesson: 5},
      {dict: "かう", kanji: "<ruby>買<rt>か</rt></ruby>う", type: "u-verb",
      te: ["かって","買って"], masu: ["かいます","買います"], meaning: "to buy", lesson: 4},
      {dict: "かく", kanji: "<ruby>書<rt>か</rt></ruby>く", type: "u-verb",
      te: ["かいて","書いて"], masu: ["かきます","書きます"], meaning: "to write", lesson: 4},
      {dict: "かえす", kanji: "<ruby>返<rt>かえ</rt></ruby>す", type: "u-verb",
      te: ["かえして","返して"], masu: ["かえします","返します"], meaning: "to return (a thing) (person に thing を)", lesson: 6},
      {dict: "かす", kanji: "<ruby>貸<rt>か</rt></ruby>す", type: "u-verb",
      te: ["かして","貸して"], masu: ["かします","貸します"], meaning: "to lend"},
      {dict: "きく", kanji: "<ruby>聞<rt>き</rt></ruby>く", type: "u-verb",
      te: ["きいて","聞いて"], masu: ["ききます","聞きます"], meaning: "to ask; to listen", lesson: [3, 5]},
      {dict: "けす", kanji: "<ruby>消<rt>け</rt></ruby>す", type: "u-verb",
      te: ["けして","消して"], masu: ["けします","消します"], meaning: "to erase; to turn off", lesson: 6},
      {dict: "すわる", kanji: "<ruby>座<rt>すわ</rt></ruby>る", type: "u-verb",
      te: ["すわって","座って"], masu: ["すわります","座ります"], meaning: "to sit down (seat に)", lesson: 6},
      {dict: "たつ", kanji: "<ruby>立<rt>た</rt></ruby>つ", type: "u-verb",
      te: ["たって","立って"], masu: ["たちます","立ちます"], meaning: "to stand up", lesson: 6},
      {dict: "つかう", kanji: "<ruby>使<rt>つか</rt></ruby>う", type: "u-verb",
      te: ["つかって","使って"], masu: ["つかいます","使います"], meaning: "to use (~を)", lesson: 6},
      {dict: "てつだう", kanji: "<ruby>手伝<rt>てつだ</rt></ruby>う", type: "u-verb",
      te: ["てつだって","手伝って"], masu: ["てつだいます","手伝います"], meaning: "to help (person/task を)", lesson: 6},
      {dict: "とる", kanji: "<ruby>取<rt>と</rt></ruby>る", type: "u-verb",
      te: ["とって","取って"], masu: ["とります","取ります"], meaning: "to take"},
      {dict: "とる", kanji: "<ruby>撮<rt>と</rt></ruby>る", type: "u-verb",
      te: ["とって","撮って"], masu: ["とります","撮ります"], meaning: "to take (a picture) (~を)", lesson: 4},
      {dict: "なくす", kanji: "<ruby>失<rt>な</rt></ruby>くす", type: "u-verb",
      te: ["なくして","失くして"], masu: ["なくします","失くします"], meaning: "to lose"},
      {dict: "のむ", kanji: "<ruby>飲<rt>の</rt></ruby>む", type: "u-verb",
      te: ["のんで","飲んで"], masu: ["のみます","飲みます"], meaning: "to drink", lesson: 3},
      {dict: "しぬ", kanji: "<ruby>死<rt>し</rt></ruby>ぬ", type: "u-verb",
      te: ["しんで","死んで"], masu: ["しにます","死にます"], meaning: "to die", lesson: 6},
      {dict: "のる", kanji: "<ruby>乗<rt>の</rt></ruby>る", type: "u-verb",
      te: ["のって","乗って"], masu: ["のります","乗ります"], meaning: "to ride; to board (~に)", lesson: 5},
      {dict: "はいる", kanji: "<ruby>入<rt>はい</rt></ruby>る", type: "u-verb",
      te: ["はいって","入って"], masu: ["はいります","入ります"], meaning: "to enter (~に)", lesson: 6},
      {dict: "はじまる", kanji: "<ruby>始<rt>はじ</rt></ruby>まる", type: "u-verb",
      te: ["はじまって","始まって"], masu: ["はじまります","始まります"], meaning: "something begins"},
      {dict: "はなす", kanji: "<ruby>話<rt>はな</rt></ruby>す", type: "u-verb",
      te: ["はなして","話して"], masu: ["はなします","話します"], meaning: "to speak; to talk", lesson: 3},
      {dict: "はらう", kanji: "<ruby>払<rt>はら</rt></ruby>う", type: "u-verb",
      te: ["はらって","払って"], masu: ["はらいます","払います"], meaning: "to pay"},
      {dict: "ひく", kanji: "<ruby>弾<rt>ひ</rt></ruby>く", type: "u-verb",
      te: ["ひいて","弾いて"], masu: ["ひきます","弾きます"], meaning: "to play (a string instrument or piano) (~を)", lesson: 9},
      {dict: "もつ", kanji: "<ruby>持<rt>も</rt></ruby>つ", type: "u-verb",
      te: ["もって","持って"], masu: ["もちます","持ちます"], meaning: "to hold"},
      {dict: "やすむ", kanji: "<ruby>休<rt>やす</rt></ruby>む", type: "u-verb",
      te: ["やすんで","休んで"], masu: ["やすみます","休みます"], meaning: "to be absent (from...) (~を); to rest", lesson: 6},
      {dict: "よむ", kanji: "<ruby>読<rt>よ</rt></ruby>む", type: "u-verb",
      te: ["よんで","読んで"], masu: ["よみます","読みます"], meaning: "to read", lesson: 3},
      {dict: "かえる", kanji: "<ruby>帰<rt>かえ</rt></ruby>る", type: "u-verb",
      te: ["かえって","帰って"], masu: ["かえります","帰ります"], meaning: "to go back; to return", lesson: 3},
      {dict: "まつ", kanji: "<ruby>待<rt>ま</rt></ruby>つ", type: "u-verb",
      te: ["まって","待って"], masu: ["まちます","待ちます"], meaning: "to wait (~を)", lesson: 4},
      {dict: "わかる", kanji: "<ruby>分<rt>わ</rt></ruby>かる", type: "u-verb",
      te: ["わかって","分かって"], masu: ["わかります","分かります"], meaning: "to understand (~が)", lesson: 4},
      {dict: "やる", type: "u-verb",
      te: ["やって"], masu: ["やります"], meaning: "to to do; to perform (~を)", lesson: 5},
      {dict: "タバコをすう", kanji: "タバコを<ruby>吸<rt>す</rt></ruby>う", type: "u-verb",
      te: ["タバコをすって","タバコを吸って"], masu: ["タバコをすいます","タバコを吸います"], meaning: "to smoke", lesson: 6},
      {dict: "もつ", kanji: "<ruby>持<rt>も</rt></ruby>つ", type: "u-verb",
      te: ["もって","持って"], masu: ["もちます","持ちます"], meaning: "to carry; to hold (~を)", lesson: 6},
      {dict: "すむ", kanji: "<ruby>住<rt>す</rt></ruby>む", type: "u-verb",
      te: ["すんで","住んで"], masu: ["すみます","住みます"], meaning: "to live (~もすんでいます)", lesson: 7},
      {dict: "あらう", kanji: "<ruby>洗<rt>あ</rt></ruby>らう", type: "u-verb",
      te: ["あらって","洗って"], masu: ["あらいます","洗います"], meaning: "to wash (~を)", lesson: 8},
      {dict: "いる", type: "u-verb",
      te: ["いって"], masu: ["いります"], meaning: "to need (~が)", lesson: 8},
      {dict: "おそくなる", kanji: "<ruby>遅<rt>おそ</rt></ruby>くなる", type: "u-verb",
      te: ["おそくなって","遅くなって"], masu: ["おそくなります","遅くなります"], meaning: "to be late", lesson: 8},
      {dict: "おふろにはいる", kanji: "お<ruby>風呂<rt>ふろ</rt></ruby>に<ruby>入<rt>はい</rt></ruby>る", type: "u-verb",
      te: ["おふろにはいって","お風呂に入って"], masu: ["おふろにはいるます","お風呂に入ります"], meaning: "to take a bath", lesson: 8},
      {dict: "おもう", kanji: "<ruby>思<rt>おも</rt></ruby>う", type: "u-verb",
      te: ["おもって","思って"], masu: ["おもいます","思います"], meaning: "to think", lesson: 8},
      {dict: "きる", kanji: "<ruby>切<rt>き</rt></ruby>る", type: "u-verb",
      te: ["きって","切って"], masu: ["きります","切ります"], meaning: "to cut (~を)", lesson: 8},
      {dict: "つくる", kanji: "<ruby>作<rt>つく</rt></ruby>る", type: "u-verb",
      te: ["つくって","作って"], masu: ["つくります","作ります"], meaning: "to make (~を)", lesson: 8},
      {dict:"(あめ/ゆきが)ふる", kanji:"<ruby>雨<rt>あめ</rt></ruby>/<ruby>雪<rt>ゆき</rt></ruby>が<ruby>降<rt>ふ</rt></ruby>る", type:"u-verb",
      te:["ふって","降って"], masu:["ふります","降ります"], meaning:"(rain/snow) falls", lesson: 8},
      {dict: "もっていく", kanji: "<ruby>持<rt>も</rt></ruby>っていく", type: "u-verb",
      te: ["もっていって","持っていって"], masu: ["もっていきます","持っていきます"], meaning: "to take (a thing) (~を)", lesson: 8},
      {dict: "くすりをのむ", kanji: "<ruby>薬<rt>くすり</rt></ruby>を<ruby>飲<rt>の</rt></ruby>む", type: "u-verb",
      te: ["くすりをのんで","薬を飲んで"], masu: ["くすりをのみます","薬を飲みます"], meaning: "to take medicine", lesson: 9},
      {dict: "にんきがある", kanji: "<ruby>人気<rt>にんき</rt></ruby>がある", type: "u-verb",
      te: ["にんきがあって","人気があって"], masu: ["にんきがあります","人気があります"], meaning: "to be popular", lesson: 9},
      {dict: "はじまる", kanji: "<ruby>始<rt>はじ</rt></ruby>まる", type: "u-verb",
      te: ["はじまって","始まって"], masu: ["はじまります","始まります"], meaning: "something begins (~が)", lesson: 9},
      {dict: "もらう", type: "u-verb",
      te: ["もらいて"], masu: ["もらいます"], meaning: "to get (from somebody) (person に thing を)", lesson: 9},
      {dict: "かかる", type: "u-verb",
      te: ["かかって"], masu: ["かかります"], meaning: "to take (amount of time/money) (no particle)", lesson: 10},
      {dict: "とまる", kanji: "<ruby>泊<rt>と</rt></ruby>まる", type: "u-verb",
      te: ["とまって","泊まって"], masu: ["とまります","泊まります"], meaning: "to stay (at a hotel, etc.) (~に)", lesson: 10},
      {dict: "なる", type: "u-verb",
      te: ["なって"], masu: ["なります"], meaning: "to become", lesson: 10},
      {dict: "うそをつく", type: "u-verb",
      te: ["うそをついて"], masu: ["うそをつきます"], meaning: "to tell a lie", lesson: 10},
      
      // ==== Ru-verbs ====
      {dict: "あける", kanji: "<ruby>開<rt>あ</rt></ruby>ける", type: "ru-verb",
      te: ["あけて","開けて"], masu: ["あけます","開けます"], meaning: "to open (something) (~を)", lesson: 6},
      {dict: "あげる", kanji: "<ruby>上<rt>あ</rt></ruby>げる", type: "ru-verb",
      te: ["あげて","上げて"], masu: ["あげます","上げます"], meaning: "to give"},
      {dict: "おきる", kanji: "<ruby>起<rt>お</rt></ruby>きる", type: "ru-verb",
      te: ["おきて","起きて"], masu: ["おきます","起きます"], meaning: "to get up", lesson: 3},
      {dict: "おしえる", kanji: "<ruby>教<rt>おし</rt></ruby>える", type: "ru-verb",
      te: ["おしえて","教えて"], masu: ["おしえます","教えます"], meaning: "to teach; to instruct (person に thing を)", lesson: 6},
      {dict: "おりる", kanji: "<ruby>降<rt>お</rt></ruby>りる", type: "ru-verb",
      te: ["おりて","降りて"], masu: ["おります","降ります"], meaning: "to get off (~を)", lesson: 6},
      {dict: "かける", kanji: "<ruby>掛<rt>か</rt></ruby>ける", type: "ru-verb",
      te: ["かけて","掛けて"], masu: ["かけます","掛けます"], meaning: "to put on (glasses)", lesson: 7},
      {dict: "かりる", kanji: "<ruby>借<rt>か</rt></ruby>りる", type: "ru-verb",
      te: ["かりて","借りて"], masu: ["かります","借ります"], meaning: "to borrow (person に thing を", lesson: 6},
      {dict: "きる", kanji: "<ruby>着<rt>き</rt></ruby>る", type: "ru-verb",
      te: ["きて","着て"], masu: ["きます","着ます"], meaning: "to wear"},
      {dict: "しめる", kanji: "<ruby>閉<rt>し</rt></ruby>める", type: "ru-verb",
      te: ["しめて","閉めて"], masu: ["しめます","閉めます"], meaning: "to close (something) (~を)", lesson: 6},
      {dict: "つける", kanji: "つける", type: "ru-verb",
      te: ["つけて"], masu: ["つけます"], meaning: "to turn on"},
      {dict: "でかける", kanji: "<ruby>出<rt>で</rt></ruby>かける", type: "ru-verb",
      te: ["でかけて","出かけて"], masu: ["でかけます","出かけます"], meaning: "to go out", lesson: 5},
      {dict: "でる", kanji: "<ruby>出<rt>で</rt></ruby>る", type: "ru-verb",
      te: ["でて","出て"], masu: ["でます","出ます"], meaning: "to leave"},
      {dict: "ねる", kanji: "<ruby>寝<rt>ね</rt></ruby>る", type: "ru-verb",
      te: ["ねて","寝て"], masu: ["ねます","寝ます"], meaning: "to sleep", lesson: 3},
      {dict: "みる", kanji: "<ruby>見<rt>み</rt></ruby>る", type: "ru-verb",
      te: ["みて","見て"], masu: ["みます","見ます"], meaning: "to see; to look at; to watch", lesson: 3},
      {dict: "わすれる", kanji: "<ruby>忘<rt>わす</rt></ruby>れる", type: "ru-verb",
      te: ["わすれて","忘れて"], masu: ["わすれます","忘れます"], meaning: "to forget; to leave behind (~を)", lesson: 6},
      {dict: "シャワーをあびる", kanji: "シャワーをあびる", type: "ru-verb",
      te: ["シャワーをあびて"], masu: ["シャワーをあびます"], meaning: "to take a shower", lesson: 6},
      {dict: "やせる", kanji: "やせる", type: "ru-verb",
      te: ["やせて"], masu: ["やせます"], meaning: "to lose weight", lesson: 7},
      {dict: "たべる", kanji: "<ruby>食<rt>た</rt></ruby>べる", type: "ru-verb",
      te: ["たべて","食べて"], masu: ["たべます","食べます"], meaning: "to eat", lesson: 3},
      {dict: "いる", type: "ru-verb",
      te: ["いて"], masu: ["います"], meaning: "(a person) is in ...; stays at... (place に person が)", lesson: 4},
      {dict: "きる", kanji: "<ruby>着<rt>き</rt></ruby>る", type: "ru-verb",
      te: ["きて","着て"], masu: ["きます","着ます"], meaning: "to put on (clothes above your waist) (~を)", lesson: 7},
      {dict: "やせる", type: "ru-verb",
      te: ["やせて"], masu: ["やせます"], meaning: "to be thin", lesson: 7},
      {dict: "すてる", kanji: "<ruby>捨<rt>す</rt></ruby>てる", type: "ru-verb",
      te: ["すてて","捨てて"], masu: ["すてます","捨てます"], meaning: "to throw away (~を)", lesson: 8},
      {dict: "はじめる", kanji: "<ruby>始<rt>はじ</rt></ruby>める", type: "ru-verb",
      te: ["はじめて","始めて"], masu: ["はじめます","始めます"], meaning: "to begin (~を)", lesson: 8},
      {dict: "きめる", kanji: "<ruby>決<rt>き</rt></ruby>める", type: "ru-verb",
      te: ["きめて","決めて"], masu: ["きめます","決めます"], meaning: "to decide (~を)", lesson: 10},

      // ==== Irregular ====
      {dict: "くる", kanji: "<ruby>来<rt>く</rt></ruby>る", type: "irregular",
      te: ["きて","来て"], masu: ["きます","来ます"], meaning: "to come", lesson: 3},
      {dict: "する", kanji: "する", type: "irregular",
      te: ["して"], masu: ["します"], meaning: "to do", lesson: 3},
      {dict: "べんきょうする", kanji: "<ruby>勉強<rt>べんきょう</rt></ruby>する", type: "irregular",
      te: ["べんきょうして","勉強して"], masu: ["べんきょうします","勉強します"], meaning: "to study", lesson: 3},
      {dict: "けっこんする", kanji: "<ruby>結婚<rt>けっこん</rt></ruby>する", type: "irregular",
      te: ["けっこんして","結婚して"], masu: ["けっこんします","結婚します"], meaning: "to get married (~と)", lesson: 7},
      {dict: "さんぽする", kanji: "<ruby>散歩<rt>さんぽ</rt></ruby>する", type: "irregular",
      te: ["さんぽして","散歩して"], masu: ["さんぽします","散歩します"], meaning: "to take a walk", lesson: 9},
      {dict: "うんてんする", kanji: "<ruby>運転<rt>うんてん</rt></ruby>する", type: "irregular",
      te: ["うんてんして","運転して"], masu: ["うんてんします","運転します"], meaning: "to drive (~を)", lesson: 8},
      {dict: "りょこうする", kanji: "<ruby>旅行<rt>りょこう</rt></ruby>する", type: "irregular",
      te: ["りょこうして","旅行して"], masu: ["りょこうします","旅行します"], meaning: "to travel", lesson: 10},
      {dict: "そうじする", kanji: "<ruby>掃除<rt>そうじ</rt></ruby>する", type: "irregular",
      te: ["そうじして","掃除して"], masu: ["そうじします","掃除します"], meaning: "to clean (~を)", lesson: 8},
      {dict: "でんわする", kanji: "<ruby>電話<rt>でんわ</rt></ruby>する", type: "irregular",
      te: ["でんわして","電話して"], masu: ["でんわします","電話します"], meaning: "to call (~に)", lesson: 6},
      {dict: "つれてくる", kanji: "<ruby>連<rt>つ</rt></ruby>れてくる", type: "irregular",
      te: ["つれてきて","連れてきて"], masu: ["つれてきます","連れてきます"], meaning: "to bring (a person) (~を)", lesson: 6},
      {dict: "もってくる", kanji: "<ruby>持<rt>も</rt></ruby>ってくる", type: "irregular",
      te: ["もってきて","持ってきて"], masu: ["もってきます","持ってきます"], meaning: "to bring (a thing) (~を)", lesson: 6},
      {dict: "せんたくする", kanji: "<ruby>洗濯<rt>せんたく</rt></ruby>する", type: "irregular",
      te: ["せんたくして","洗濯して"], masu: ["せんたくします","洗濯します"], meaning: "to do laundry (~を)", lesson: 8},
      {dict: "りょうりする", kanji: "<ruby>料理<rt>りょうり</rt></ruby>する", type: "irregular",
      te: ["りょうりして","料理して"], masu: ["りょうりします","料理します"], meaning: "to cook", lesson: 8},
      {dict: "うんどうする", kanji: "<ruby>運動<rt>うんどう</rt></ruby>する", type: "irregular",
      te: ["うんどうして","運動して"], masu: ["うんどうします","運動します"], meaning: "to exercise", lesson: 9},
      {dict: "ごろごろする", type: "irregular",
      te: ["ごろごろして"], masu: ["ごろごろします"], meaning: "to chillout at home; to stay home and do nothing", lesson: 10},
      {dict: "れんしゅうする", kanji: "<ruby>練習<rt>れんしゅう</rt></ruby>する", type: "irregular",
      te: ["れんしゅうして","練習して"], masu: ["れんしゅうします","練習します"], meaning: "to practice (~を)", lesson: 10}
    ];

    document.getElementById("totalVerbs").textContent = verbs.length;

    // Build lesson dropdown dynamically
    function buildLessonDropdown() {
      const lessons = new Set();
      verbs.forEach(v => {
        if (Array.isArray(v.lesson)) {
          v.lesson.forEach(l => lessons.add(l));
        } else if (v.lesson) {
          lessons.add(v.lesson);
        }
      });      
      const dropdown = document.getElementById("lessonFilter");
      dropdown.innerHTML = `<option value="all">All Lessons</option>`;
      [...lessons].sort((a, b) => a - b).forEach(l => {
        dropdown.innerHTML += `<option value="${l}">Lesson ${l}</option>`;
      });
    }

// Run it once on page load
buildLessonDropdown();


    function startQuiz() {
      document.getElementById("menu").style.display = "none";
      document.getElementById("quiz").style.display = "block";
    }

    function showList() {
      document.getElementById("menu").style.display = "none";
      document.getElementById("list").style.display = "block";
      const container = document.getElementById("verbTables");
      container.innerHTML = "";

      // Group verbs by lesson
      const grouped = {};
      verbs.forEach(v => {
        if (Array.isArray(v.lesson)) {
          v.lesson.forEach(l => {
            if (!grouped[l]) grouped[l] = [];
            grouped[l].push(v);
          });
        } else {
          if (!grouped[v.lesson]) grouped[v.lesson] = [];
          grouped[v.lesson].push(v);
        }
      });

      Object.keys(grouped).sort((a, b) => a - b).forEach(lesson => {
        const verbsForLesson = grouped[lesson];
        let table = `
          <h3 class="lesson-heading">Lesson ${lesson}</h3>
          <table class="table table-striped table-bordered">
            <thead class="table-dark">
              <tr>
                <th>Kanji</th>
                <th>Dict</th>
                <th>Te-form(s)</th>
                <th>Masu-form(s)</th>
                <th>Type</th>
                <th>Meaning</th>
              </tr>
            </thead>
            <tbody>
        `;
        verbsForLesson.forEach(v => {
          table += `
            <tr>
              <td>${v.kanji || ""}</td>
              <td>${v.dict}</td>
              <td>${v.te.join(", ")}</td>
              <td>${v.masu.join(", ")}</td>
              <td>${v.type}</td>
              <td>${v.meaning}</td>
            </tr>`;
        });
        table += "</tbody></table>";
        container.innerHTML += table;
      });
    }

    let currentQuestions = [];
    let currentType = "te";

    function generateQuiz() {
      const numInput = document.getElementById("numQuestions");
      const lesson = document.getElementById("lessonFilter").value;
      currentType = document.getElementById("quizType").value;

      let pool = verbs;

      // filter by lesson
      if (lesson !== "all") {
        pool = verbs.filter(v => 
          Array.isArray(v.lesson) ? v.lesson.includes(parseInt(lesson)) : v.lesson == lesson
        );
      }

      // skip irregulars if checked
      const skipIrregular = document.getElementById("skipIrregular").checked;
      if (skipIrregular) {
        pool = pool.filter(v => v.type !== "irregular");
      }

      // ✅ update available number dynamically
      document.getElementById("totalVerbs").textContent = pool.length;

      const num = Math.min(parseInt(numInput.value), pool.length);
      currentQuestions = shuffle([...pool]).slice(0, num);

      const form = document.getElementById("quizForm");
      form.innerHTML = "";
      currentQuestions.forEach((v, i) => {
        form.innerHTML += `
          <div class="mb-3">
            <label class="form-label">Q${i+1}: ${(v.kanji || v.dict)} (${v.meaning}) → ${currentType}-form?</label>
            <input type="text" class="form-control" name="q${i}" data-answers='${JSON.stringify(v[currentType])}'>
          </div>
        `;
      });
      form.innerHTML += `<button type="submit" class="btn btn-success">Submit Answers</button>`;
    }


    function checkAnswers() {
      let score = 0;
      let output = "";
      currentQuestions.forEach((v, i) => {
        const input = document.querySelector(`[name=q${i}]`);
        const userAnswer = input.value.trim();
        const validAnswers = JSON.parse(input.getAttribute("data-answers"));
        if (validAnswers.includes(userAnswer)) {
          score++;
          output += `
            <div class="alert alert-success">
              ✅ Q${i+1}: Correct! <br>
              Your answer: <b>${userAnswer}</b><br>
              Acceptable answers: ${validAnswers.join(", ")} (${v.type})
            </div>`;
        } else {
          output += `
            <div class="alert alert-danger">
              ❌ Q${i+1}: Incorrect <br>
              Your answer: <b>${userAnswer}</b><br>
              Acceptable answers: ${validAnswers.join(", ")} (${v.type})
            </div>`;
        }
      });
      output += `<p class="fw-bold">Final Score: ${score}/${currentQuestions.length}</p>`;

      document.getElementById("quiz").style.display = "none";
      document.getElementById("results").style.display = "block";
      document.getElementById("resultsContent").innerHTML = output;
    }

    function reset() {
      document.getElementById("quiz").style.display = "none";
      document.getElementById("results").style.display = "none";
      document.getElementById("list").style.display = "none";
      document.getElementById("menu").style.display = "block";
    }

    // Fisher-Yates shuffle
    function shuffle(array) {
      let m = array.length, t, i;
      while (m) {
        i = Math.floor(Math.random() * m--);
        t = array[m]; array[m] = array[i]; array[i] = t;
      }
      return array;
    }
  </script>
</body>
</html>
